%% Graphite Diffusion Coefficient Function

% The data is from:
% Investigation of Lithium Ion Diffusion of Graphite Anode by
% the Galvanostatic Intermittent Titration Technique
% By: Jong Hyun Park et al 2021 Materials 14,4683

function [D_o] = D_o_Graphite(X)
%% Data from Literature
data = [
0.05670103092783507, 1.0494229325736952e-11
0.07319587628865981, 1.0090937224734170e-11
0.08969072164948455, 1.2026321162501128e-11
0.10515463917525775, 1.4333044817400660e-11
0.12164948453608249, 1.7589423935798552e-11
0.13814432989690723, 1.0692518933799647e-11
0.15360824742268042, 1.4608570582448442e-10
0.17010309278350516, 2.7809862830847324e-10
0.18659793814432990, 4.7553205862976360e-10
0.20206185567010304, 1.8454289384967820e-10
0.21752577319587630, 8.7901827286249730e-11
0.23505154639175252, 7.4454292847963860e-11
0.25154639175257730, 6.3682959742530690e-11
0.26701030927835057, 7.5897749923766750e-11
0.28350515463917525, 1.0369366576060434e-10
0.29896907216494850, 7.1559904716850520e-11
0.31546391752577320, 1.4585519227523788e-10
0.33298969072164950, 1.9352139603097277e-10
0.34742268041237110, 2.4454722938260980e-10
0.36391752577319590, 3.9438462165877450e-10
0.38041237113402060, 2.7483397397806570e-10
0.39690721649484540, 2.3970577119412953e-10
0.41237113402061853, 4.1796353048982103e-10
0.42886597938144333, 4.5182140384914380e-10
0.44639175257731956, 6.2333720218890000e-10
0.46185567010309280, 4.8360193594771910e-10
0.47731958762886595, 3.7887007355920780e-10
0.49484536082474230, 4.6950084638618500e-10
0.50927835051546400, 3.8246541710705070e-10
0.52577319587628870, 3.5025688849700925e-10
0.54226804123711350, 4.1743415270868100e-10
0.55773195876288660, 4.8314976795306300e-10
0.57525773195876280, 3.8975094293164283e-10
0.59072164948453620, 3.2060913085323716e-10
0.60618556701030930, 2.5863662396894180e-10
0.62371134020618560, 4.4658475810340030e-11
0.63917525773195870, 2.9351816364417010e-10
0.65670103092783520, 4.1696835163166600e-10
0.67319587628865980, 4.3774343350762093e-10
0.68762886597938140, 4.0878736727424535e-10
0.70412371134020610, 4.4190190933929623e-10
0.72061855670103100, 3.7066774689526833e-10
0.73711340206185570, 3.9295121286420180e-10
0.75360824742268040, 4.0852429831146213e-10
0.76804123711340200, 4.5920244693480660e-10
0.78556701030927840, 3.5974745352604274e-10
0.80206185567010310, 3.4592239769206127e-10
0.81752577319587630, 4.6802504061970720e-10
0.83402061855670100, 5.2607377654997240e-10
0.85051546391752590, 4.2438147845378170e-10
0.86701030927835050, 4.2431318589119393e-10
0.88350515463917520, 3.7007913534010363e-10
0.89999999999999990, 4.0005804876967630e-10
0.91546391752577330, 3.9999769374097205e-10
0.93092783505154640, 3.5923760536038190e-10
0.94742268041237110, 3.6625745694856060e-10
0.96391752577319580, 3.9980864027456154e-10
0.97938144329896910, 4.1973297645495450e-10];

%% Convert from cm^2/s to m^2 /s
data(:,2)  = data(:,2) *1e-4;

%% Interpolating the data Test
OG_size = size(X);
X = reshape(X,[],1);
D_o  = exp(interp1(data(:,1) ,log(data(:,2)),X) ); 

%% Handle when X is out of range of the data
idx  = isnan(D_o);
for i = 1:length(X)
    if (idx(i) && (X(i) < data(1,1)) )
        D_o(i) = data(1,2);
    elseif (idx(i) && (X(i) > data(end,1)) )
        D_o(i) = data(end,2);
    end
end

%% Reshape the output
D_o = reshape(D_o,OG_size);
end